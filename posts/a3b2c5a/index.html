<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.2.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/logo-32px.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/logo-32px.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/logo-16px.png"><link rel="mask-icon" href="/images/logo.png" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.css"><script src="//cdn.jsdelivr.net/npm/pace-js@1/pace.min.js"></script><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"eonun.com",root:"/",scheme:"Pisces",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!1,style:null},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!0,color:"#4848FF",save:"auto"},fancybox:!0,mediumzoom:!1,lazyload:!0,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="装系统时难免会接触到BIOS、UEFI、MBR、GPT等概念，一下子有些混淆不清，本文就这些概念进行总结"><meta property="og:type" content="article"><meta property="og:title" content="BIOS、UEFI、MBR、GPT都是啥呢"><meta property="og:url" content="https://eonun.com/posts/a3b2c5a/index.html"><meta property="og:site_name" content="木He寸&amp;柽-eonun&#39;s Blog"><meta property="og:description" content="装系统时难免会接触到BIOS、UEFI、MBR、GPT等概念，一下子有些混淆不清，本文就这些概念进行总结"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2019-12-06T08:02:33.000Z"><meta property="article:modified_time" content="2020-12-18T16:08:39.659Z"><meta property="article:author" content="木He寸&amp;柽-eonun"><meta property="article:tag" content="BIOS"><meta property="article:tag" content="UEFI"><meta property="article:tag" content="MBR"><meta property="article:tag" content="GPT"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://eonun.com/posts/a3b2c5a/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>BIOS、UEFI、MBR、GPT都是啥呢 | 木He寸&柽-eonun's Blog</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="木He寸&柽-eonun's Blog" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><script type="text/javascript" src="/js/clicklove.js"></script><div class="container use-motion"><div class="headband"></div><a target="_blank" rel="noopener" href="https://github.com/eonun" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#70b7fd;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">木He寸&柽-eonun's Blog</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">记录积累方有成长</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><a role="button" class="book-mark-link book-mark-link-fixed"></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://eonun.com/posts/a3b2c5a/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/me.png"><meta itemprop="name" content="木He寸&柽-eonun"><meta itemprop="description" content="努力即为天意！"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="木He寸&柽-eonun's Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">BIOS、UEFI、MBR、GPT都是啥呢</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-12-06 16:02:33" itemprop="dateCreated datePublished" datetime="2019-12-06T16:02:33+08:00">2019-12-06</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2020-12-19 00:08:39" itemprop="dateModified" datetime="2020-12-19T00:08:39+08:00">2020-12-19</time> </span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><p>装系统时难免会接触到BIOS、UEFI、MBR、GPT等概念，一下子有些混淆不清，本文就这些概念进行总结</p><a id="more"></a><h1 id="启动模式"><a href="#启动模式" class="headerlink" title="启动模式"></a>启动模式</h1><p>BIOS(<code>Basic Input/Output System</code>)是存储在BIOS芯片中的程序，现在的新式电脑用的基本都是UEFI(<code>Unified Extensible Firmware Interface</code>)（基本见于09年以后的主板），早期的过渡电脑用的都是EFI启动。EFI或UEFI的一部分是存储在EFI/UEFI BIOS芯片。EFI/UEFI也叫做EFI/UEFI BIOS，但在实际上它们和BIOS是不一样的，所以一般把后面的“BIOS”尾巴去掉，下面就来具体谈一下BIOS、EFI和UEFI。</p><h2 id="BIOS"><a href="#BIOS" class="headerlink" title="BIOS"></a>BIOS</h2><p><strong>BIOS只认识设备，不认识分区、不认识文件</strong></p><font color="ff0000">BIOS启动的时候，按照CMOS设置里的顺序，挨个查存储设备的前512字节，若是以0x55 0xAA结尾，则这个磁盘可以启动，加载这512字节里的代码并执行,执行后事几乎就跟BIOS关系了，若不是，那就跳过找下一个设备。</font><blockquote><p>这512字节里存了决定启动什么系统的相应代码。这个代码是系统安装程序写进去的，目的是启动自身系统。512字节还包含了MBR分区表的信息，而BIOS并不认识分区表，所以就算是磁盘上没有分区表也没有分区，只要前512字节有0x55 0xAA的结尾，有引导代码，也是能启动系统</p><p>BIOS本身是汇编语言代码，是在16位实模式下调用INT 13H中断执行的，16位实模式直接能访问的内存只有1MB，就算装了4G、8G或者16G还是32G内存，到了BIOS上一律只先认前1MB。在这1MB内存中，前640K称为基本内存，后面384K内存留给开机必要硬件和各类BIOS本身使用</p></blockquote><p>BIOS用于计算机硬件自检和初始化、CMOS设置、引导操作系统启动、提供硬件I/O、硬件中断等主要功能</p><p><a href="#bios">BIOS启动计算机的具体过程</a></p><h2 id="UEFI"><a href="#UEFI" class="headerlink" title="UEFI"></a>UEFI</h2><h3 id="EFI"><a href="#EFI" class="headerlink" title="EFI"></a>EFI</h3><p><strong>EFI（Extensible Firmware Interface，可扩展固件接口）</strong>，是用模块化、高级语言（主要是C语言）构建的一个小型化系统，和BIOS一样，<strong>主要在启动过程中完成硬件初始化</strong>，但它是直接利用加载EFI驱动的方式，识别系统硬件并完成硬件初始化，彻底摒弃读各种中断执行。EFI驱动并不是直接面向CPU的代码，而是由EFI字节码编写成，EFI字节码是专用于EFI的虚拟机器指令，需要在EFI驱动运行环境DXE下解释运行，这样EFI既可以实现通配，又提供了良好的兼容，因此<strong>与BIOS不同的是CMOS设置程序在EFI上是作为一个个EFI程序来执行的，硬件设置是硬件设置程序、而启动管理则是另一个程序，保存CMOS又是另一个程序</strong>。此外，<strong>EFI完全是32位或64位，摒弃16位实模式，在EFI中就可以实现处理器的最大寻址</strong>，因此可以在任何内存地址存放任何信息。</p><p>EFI在功能上完全等同于一个轻量化的OS（操作系统），但EFI在制定时就定位到不足以成为专业OS的地位上，它只是一个硬件和操作系统间的一个接口；不提供中断访问机制，EFI必须用轮询的方式检查并解释硬件，较OS下的驱动执行效率较低；EFI只有简单的存储器管理机制，在段保护模式下只将存储器分段，所有程序都可以存取任何一段位置，不提供真实的保护服务。伴随着EFI，一种全新的GUID磁盘分区系统（GPT）被引入支持。</p><p>在EFI发展到1.1的时候，英特尔把EFI公之于众，后续的2.0吸引了众多公司加入，EFI也不再属于英特尔，而是属于了Unified EFI Form的国际组织，EFI在2.0后也改称为UEFI，EFI和原来是一个意思，U则是Unified（一元化、统一）的缩写，所以UEFI的意思就是“统一的可扩展固件接口”</p><h3 id="UEFI-1"><a href="#UEFI-1" class="headerlink" title="UEFI"></a>UEFI</h3><p><strong>UEFI认识设备，还认识设备ROM，还认识分区表、认识文件系统以及文件</strong></p><p>UEFI启动的时候，经过一系列初始化，然后按照设置的顺序，找启动项。启动项分设备启动项和文件启动项两种：</p><ul><li>文件启动项，大概记录的是某磁盘的某分区的某路径下的某个文件。对于文件启动项，固件会直接加载这个EFI文件，并执行，文件不存在则失败。</li><li>设备启动项，大概记录的是某U盘、某硬盘等设备启动项，且UEFI标准规定了其默认的路径<code>\EFI\Boot\bootX64.efi</code>。UEFI会加载磁盘上的这个文件，文件不存在则失败。</li></ul><font color="ff0000">UEFI启动后，进入DXE（Driver eXecution Environment，驱动程序执行环境）阶段，开始加载设备驱动，然后获得设备列表。对于磁盘，UEFI会加载对应的驱动解析其中的分区表（GPT和MBR）。然后UEFI就会用内置的文件系统驱动，解析每个分区从中认识出启动文件，比如`\EFI\Boot\bootX64.efi`</font><p><a href="#uefi">UEFI启动计算机的具体过程</a></p><blockquote><p>UEFI标准里，在GPT分区表的基础上，规定了一个EFI系统分区（EFI System Partition，ESP），ESP要格式化成FAT32，EFI启动文件要放在“\EFI\&lt;厂商&gt;”文件夹下面</p><p>作为UEFI标准里，钦定的文件系统，FAT32.efi是每个主板都会带的。所有UEFI的主板都认识FAT32分区</p><p>BIOS只能在16位模式下运行，而UEFI可以在32位或64位模式下运行，具有比BIOS更多的可寻址地址空间</p><p>UEFI还包含了其他功能，它支持安全引导（SecureBoot），开启后，主板会验证即将加载的efi文件的签名，如果是不是受信任的，就会拒绝加载，以确保没有恶意软件篡改引导过程</p></blockquote><p>磁盘分区要格式化之后才能存文件，格式化成不同的文件系统，文件才能被不同的操作系统识别<br>如Win10可以选FAT32、NTFS、exFAT、ReFS等；Linux可以选ext2、ext3、ext4、FAT32等；macOS可以选FAT32、HFS+、APFS、exFAT等</p><p>其实每个操作系统都带有文件系统驱动才能读取文件系统中的文件<br>比如Windows带了FAT32、NTFS、exFAT、ReFS四种文件系统等驱动，Linux带了FAT32、ext等文件系统等驱动，macOS带了FAT32、HFS+、APFS、exFAT四种驱动以及NTFS只读驱动。<br>设备也是一样的。<br>原版的WinXP只带了IDE驱动，没有SATA驱动；原版Win7只带了IDE和SATA驱动，没带NVMe驱动；Win8/Win10则带了IDE/SATA和NVMe三种驱动；macOS10.12带了SATA驱动以及苹果专用NVMe磁盘的驱动；macOS10.13带了SATA和标准NVMe驱动。</p><p>UEFI模糊了固件和操作系统界限，设计之初就考虑到了扩展性，也是有驱动程序的。启动过程中的DXE阶段加载驱动用的</p><h2 id="UEFI和BIOS比较。"><a href="#UEFI和BIOS比较。" class="headerlink" title="UEFI和BIOS比较。"></a>UEFI和BIOS比较。</h2><p>二者显著的区别就是EFI是用模块化，C语言风格的参数堆栈传递方式，动态链接的形式构建的系统，较BIOS而言更易于实现，容错和纠错特性更强，缩短了系统研发的时间。<br>| BIOS | UEFI |<br>| —————————————————————————————— | —————————————————————————————— |<br>| 16位实模式下运行，只有1M的寻址空间 | 运行于32位或64位模式,具有更多的可寻址地址空间 |<br>| BIOS利用挂载真实模式中断的方式增加硬件功能 | 将一段类似于驱动的16位代码，放置在固定的0x000C0000至0x000DFFFF之间存储区中，运行这段代码的初始化部分，它将挂载实模式下约定的中断矢量向其他程序提供服务 |<br>| BIOS提供的服务在现实中只能提供给操作系统引导程序或MS-DOS类操作系统使用 | 具有良好的向下兼容性和被外部访问的特性 |<br>| 不支持secure boot | 支持secure boot |</p><h1 id="磁盘分区"><a href="#磁盘分区" class="headerlink" title="磁盘分区"></a>磁盘分区</h1><p>直接比较，需要细细了解的可以继续看，不想细细了读完彩色部分大概知道有什么不同就行，直接跳过前两小节即可。</p><p><strong><font color="008000">传统MBR磁盘最多有4个主分区（或3个主分区，1个扩展分区和无限制的逻辑驱动器），MBR硬盘分区最大仅支持2T容量。</font></strong></p><p><strong><font color="ff0000">GPT磁盘分区样式支持最大为128个分割，一个分割最大18 EB，只受到操作系统限制（由于分区表本身需要占用一定空间，最初规划硬盘分区时，留给分区表的空间决定了最多可以有多少个分区，IA-64版Windows限制最多有128个分区，这也是EFI标准规定的分区表的最小尺寸）。</font></strong> 与MBR分区的磁盘不同，至关重要的平台操作数据位于分区，而不是位于非分区或隐藏扇区。另外，GPT分区磁盘有备份分区表来提高分区数据结构的完整性。在UEFI系统上，通常是通过ESP分区中的EFI应用程序文件引导GPT硬盘上的操作系统，而不是活动主分区上的引导程序。</p><h2 id="MBR-Master-Boot-Record-主引导记录"><a href="#MBR-Master-Boot-Record-主引导记录" class="headerlink" title="MBR(Master Boot Record,主引导记录)"></a>MBR(Master Boot Record,主引导记录)</h2><p><strong>主引导记录（Master Boot Record，MBR）</strong>，又叫做主引导扇区，是计算机开机后访问硬盘时所必须要读取的首个扇区，它在硬盘上的三维地址为（柱面，磁头，扇区）＝（0，0，1）。有时将其开头的446字节内容特指为“主引导记录”（MBR），其后是4个16字节的“磁盘分区表”（DPT），以及2字节的结束标志（55AA）。因此，在使用“主引导记录”（MBR）这个术语的时候，需要根据具体情况判断其到底是指整个主引导扇区，还是主引导扇区的前446字节。</p><p><strong>主引导记录</strong>最开头是第一阶段引导代码。其中的硬盘引导程序的主要作用是检查分区表是否正确并且在系统硬件完成自检以后将控制权交给硬盘上的引导程序（如GNU GRUB）。它不依赖任何操作系统，而且启动代码也是可以改变的，从而能够实现多系统引导。</p><p><strong>DPT(Disk Partition Table,硬盘分区表 )</strong>占据主引导扇区的64个字节（偏移01BEH—偏移01FDH），可以对四个分区的信息进行描述，其中每个分区的信息占据16个字节。</p><p><strong>结束标志字</strong>55，AA（偏移1FEH－偏移1FFH）最后两个字节，是检验主引导记录是否有效的标志</p><p>主引导扇区记录着硬盘本身的相关信息以及硬盘各个分区的大小及位置信息，是数据信息的重要入口。如果它受到破坏，硬盘上的基本数据结构信息将会丢失，需要用繁琐的方式试探性的重建数据结构信息后才可能重新访问原先的数据。主引导扇区内的信息可以通过任何一种基于某种操作系统的分区工具软件写入，但和某种操作系统没有特定的关系，即只要创建了有效的主引导记录就可以引导任意一种操作系统。</p><p><strong>主引导记录仅仅包含一个64个字节的硬盘分区表</strong>。由于每个分区信息需要16个字节，所以对于采用MBR型分区结构的硬盘，<strong>最多只能识别4个主要分区</strong>（Primary partition）。所以对于一个采用此种分区结构的硬盘来说，想要得到4个以上的主要分区是不可能的。从而引出了扩展分区。扩展分区也是主要分区的一种，但它与主分区的不同在于<strong>理论上可以划分为无数个逻辑分区。</strong></p><p>扩展分区中逻辑驱动器的引导记录是链式的。每一个逻辑分区都有一个和MBR结构类似的<strong>扩展引导记录</strong>（EBR），其分区表的第一项指向该逻辑分区本身的引导扇区，第二项指向下一个逻辑驱动器的EBR，分区表第三、第四项没有用到。</p><ul><li><p>Windows系统默认情况下，一般都是只划分一个主分区给系统，剩余的部分全部划入扩展分区。</p></li><li><p>在MBR分区表中最多4个主分区或者3个主分区＋1个扩展分区，也就是说扩展分区只能有一个，然后可以再细分为多个逻辑分区。</p></li><li>在Linux系统中，硬盘分区命名为sda1－sda4或者hda1－hda4（其中a表示硬盘编号可能是a、b、c等等）。在MBR硬盘中，分区号1－4是主分区（或者扩展分区），逻辑分区号只能从5开始。</li><li>在MBR分区表中，一个分区最大的容量为2T，且每个分区的起始柱面必须在这个硬盘的前2T内。有一个3T的硬盘，根据要求至少要划分为2个分区，且最后一个分区的起始扇区要位于硬盘的前2T空间内。如果硬盘太大则必须改用GPT。</li></ul><h2 id="GPT-GUID-Partition-Table-全局唯一标识分区表"><a href="#GPT-GUID-Partition-Table-全局唯一标识分区表" class="headerlink" title="GPT(GUID Partition Table,全局唯一标识分区表)"></a>GPT(GUID Partition Table,全局唯一标识分区表)</h2><p><strong>全局唯一标识分区表（GUID Partition Table，GPT）</strong>是一个实体硬盘的分区表的结构布局的标准。它是可扩展固件接口（UEFI）标准（被Intel用于替代个人计算机的BIOS）的一部分，被用于替代BIOS系统中的一32bits来存储逻辑块地址和大小信息的主引导记录（MBR）分区表。对于那些扇区为512字节的磁盘，MBR分区表不支持容量大于2.2TB的分区，然而，一些硬盘制造商（诸如希捷和西部数据）注意到这个局限性，并且将他们的容量较大的磁盘升级到4KB的扇区，这意味着MBR的有效容量上限提升到16 TiB。</p><p>在MBR硬盘中，分区信息直接存储于主引导记录（MBR）中（主引导记录中还存储着系统的引导程序）。但在GPT硬盘中，分区表的位置信息储存在GPT头中。但出于兼容性考虑，硬盘的第一个扇区仍然用作MBR，之后才是GPT头。</p><p>主引导记录最开头是第一阶段引导代码。其中的硬盘引导程序的主要作用是检查分区表是否正确并且在系统硬件完成自检以后将控制权交给硬盘上的引导程序（如GNU GRUB）。它不依赖任何操作系统，而且启动代码也是可以改变的，从而能够实现多系统引导。</p><h3 id="传统MBR"><a href="#传统MBR" class="headerlink" title="传统MBR"></a>传统MBR</h3><p>在GPT分区表的最开头，出于兼容性考虑仍然存储了一份传统的MBR，用来防止不支持GPT的硬盘管理工具错误识别并破坏硬盘中的数据，这个MBR也叫做保护MBR。在支持从GPT启动的操作系统中，这里也用于存储第一阶段的启动代码。在这个MBR中，只有一个标识为0xEE的分区，以此来表示这块硬盘使用GPT分区表。不能识别GPT硬盘的操作系统通常会识别出一个未知类型的分区，并且拒绝对硬盘进行操作，除非用户特别要求删除这个分区。这就避免了意外删除分区的危险。另外，能够识别GPT分区表的操作系统会检查保护MBR中的分区表，如果分区类型不是0xEE或者MBR分区表中有多个项，也会拒绝对硬盘进行操作。</p><p>在使用MBR/GPT混合分区表的硬盘中，这部分存储了GPT分区表的一部分分区（通常是前四个分区），可以使不支持从GPT启动的操作系统从这个MBR启动，启动后只能操作MBR分区表中的分区。</p><h3 id="分区表头"><a href="#分区表头" class="headerlink" title="分区表头"></a>分区表头</h3><p>分区表头定义了硬盘的可用空间以及组成分区表的项的大小和数量。分区表头还记录了这块硬盘的GUID，记录了分区表头本身的位置(LBA 1)和大小以及备份分区表头和分区表的位置(硬盘的最后)和大小。还储存着它本身和分区表的CRC32校验。固件、引导程序和操作系统在启动时可以根据这个校验值来判断分区表是否出错，如果出错了，可以使用软件从硬盘最后的备份GPT中恢复整个分区表，如果备份GPT也校验错误，硬盘将不可使用。所以GPT硬盘的分区表不可以直接使用16进制编辑器修改</p><h3 id="分区表项"><a href="#分区表项" class="headerlink" title="分区表项"></a>分区表项</h3><p>GPT分区表使用简单而直接的方式表示分区。一个分区表项的前16字节是分区类型GUID(如，EFI系统分区的GUID类型是:<code>`C12A7328-F81F-11D2-BA4B-00A0C93EC93B</code>)。接下来的16字节是该分区唯一的GUID（这个GUID指的是该分区本身，而之前的GUID指的是该分区的类型）。再接下来是分区起始和末尾的64位LBA编号，以及分区的名字和属性。</p><h3 id="操作系统支持"><a href="#操作系统支持" class="headerlink" title="操作系统支持"></a>操作系统支持</h3><ul><li><p>现在几乎所以类Unix操作系统如FreeBSD、Linux、MacOS等都有读写支持和启动支持</p></li><li><p>Windows：</p></li></ul><blockquote><p>1：读写支持</p><p>2：启动支持</p><p>3：启动支持(需要UEFI)</p><p>4：在MBR/GPT混合硬盘中优先使用MBR</p></blockquote><div class="table-container"><table><thead><tr><th></th><th>XP</th><th>2003</th><th>vista</th><th>2008</th><th>7</th><th>2012</th><th>8</th><th>8.1</th><th>10</th><th>2016</th></tr></thead><tbody><tr><td>32位</td><td></td><td>1(SP1)</td><td>1/4</td><td>1/4</td><td>1/4</td><td>-</td><td>1/3/4</td><td>1/3/4</td><td>1/3/4</td><td>-</td></tr><tr><td>64位</td><td>1/4</td><td>1/2/3/4</td><td>1/3/4</td><td>1/2/3/4</td><td>1/3/4</td><td>1/3/4</td><td>1/3/4</td><td>1/3/4</td><td>13/4</td><td>1/3/4</td></tr></tbody></table></div><p>注意：64位2003在x64平台为<code>3</code>，在IA-64平台上为<code>2</code>；64位2008在x64平台上为<code>3</code>，在IA-64平台上为<code>2</code></p><h1 id="计算机启动过程"><a href="#计算机启动过程" class="headerlink" title="计算机启动过程"></a>计算机启动过程</h1><h2 id="BIOS启动计算机的过程"><a href="#BIOS启动计算机的过程" class="headerlink" title="BIOS启动计算机的过程"></a><span id="bios">BIOS启动计算机的过程</span></h2><p>当按下电源，主板等设备开始供电，这时电压还不稳定。在早期的南北桥主板上，由主板北桥向CPU发复位信号，对CPU初始化；稳定电压后复位信号便撤掉。现在的单南桥主板，则由CPU自身调整稳定电压达到初始化的目的，当电压稳定后，CPU便在系统BIOS保留的内存地址处执行跳转BIOS起始处指令，开始执行POST自检。</p><p>在POST自检中，BIOS只检查系统的必要核心硬件(CPU、640K基本内存、显卡)是否有问题，PS/2键盘控制器、系统时钟是否有错误等等。由于POST检查在显卡初始化以前，因此在这个阶段如发生错误，无法在屏幕上显示，不过主板上有个报警扬声器，如果主板的8255外围可编程接口芯片没有损坏的话，POST报警声音一定是会出来的。一般情况下，一声短“嘀”声基本代表正常启动，不同的错误则是不同的短“嘀”声和长“嘀”声组合。POST自检结束后，BIOS开始调用中断完成各种硬件初始化工作。</p><p>硬件初始化工作主要有两点，首先POST检测后，电脑出现了开机启动画面，这就是已经检测到了显卡并完成了初始化，但由于BIOS是在16位实模式运行，因此画面是以VGA分辨率（640*480，纵横比4:3）显示的。第二，BIOS只识别到由主引导记录（MBR）初始化的硬盘，而EFI或UEFI采用了一种新的GUID磁盘分区系统（GPT）格式，这种硬盘在BIOS下是无法识别的。硬件全部初始化完毕后进入更新ESCD阶段。</p><p>在ESCD更新阶段中，BIOS将对存储在CMOS中和操作系统交换的硬件配置数据进行检测，如果系统硬件发生变动，则会更新该数据，否则不更新保持原状不变，ESCD检测或更新结束后，BIOS将完成最后一项工作，就是启动操作系统。</p><p>最后这一步中，BIOS根据CMOS中用户指定的硬件启动顺序，读取相应设备的启动或引导记录，引导相应设备上的操作系统启动，进入操作系统，此后便由操作系统接替BIOS负责硬件和软件间的相互通信。如果发现所有硬件都没有能引导操作系统的记录，则会在屏幕上显示相应错误信息，并将电脑维持在16位实模式。</p><h2 id="UEFI启动计算机的过程"><a href="#UEFI启动计算机的过程" class="headerlink" title="UEFI启动计算机的过程"></a><span id="uefi">UEFI启动计算机的过程</span></h2><p>打开电源开关时，电脑的主要部件都开始有了供电，与BIOS不同的是，UEFI预加载环境首先开始执行，负责CPU和内存（全部容量）的初始化工作，这里如出现重要问题，电脑即使有报警喇叭也不会响，因为UEFI没有去驱动8255发声，不过预加载环境只检查CPU和内存，如果这两个主要硬件出问题，屏幕没显示可以立即确定，另外一些主板会有提供LED提示，可根据CPU或内存亮灯大致判断故障。</p><p>CPU和内存初始化成功后，DXE（Driver eXecution Environment，驱动程序执行环境）载入，当DXE载入后，UEFI就具有了枚举并加载UEFI驱动程序的能力，在此阶段，UEFI会枚举搜索各个硬件的UEFI驱动并相继加载，完成硬件初始化工作，这相比BIOS的读中断加载速度会快的多，同样如加载显卡的UEFI驱动成功，电脑也会出现启动画面，硬件驱动全部加载完毕后，最后同BIOS一样，也得去启动操作系统。</p><p>在启动操作系统的阶段，同样是根据启动记录的启动顺序，转到相应设备（仅限GPT设备，如果启动传统MBR设备，则需要打开CSM支持）的引导记录，引导操作系统并进入，注意，UEFI在检测到无任何操作系统启动设备时，会直接进入UEFI设置页面，而不是像BIOS那样黑屏显示相关信息。</p><h2 id="概括："><a href="#概括：" class="headerlink" title="概括："></a>概括：</h2><ul><li><p>BIOS先要对CPU初始化，然后跳转到BIOS启动处进行POST自检，此过程如有严重错误，则电脑会用不同的报警声音提醒，接下来采用读中断的方式加载各种硬件，完成硬件初始化后进入操作系统启动过程</p></li><li><p>而UEFI则是运行预加载环境先直接初始化CPU和内存，CPU和内存若有问题则直接黑屏，其后启动PXE采用枚举方式搜索各种硬件并加载驱动，完成硬件初始化，之后同样进入操作系统启动过程</p></li></ul><h1 id="参考，扩展"><a href="#参考，扩展" class="headerlink" title="参考，扩展"></a>参考，扩展</h1><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/54108702">电脑基础知识普及：BIOS、EFI与UEFI详解</a></p><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/31365115">科普贴：BIOS和UEFI的启动项</a></p><p><a target="_blank" rel="noopener" href="https://www.tony-yin.site/2019/01/10/Talk_BIOS_UEFI_MBR_GPT_GRUB/#GRUB%E4%BD%8D%E7%BD%AE">聊聊 BIOS、UEFI、MBR、GPT、GRUB……</a></p><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Partition_table">分区表</a></p></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-paw"></i>感谢阅读-------------</div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者： </strong>木He寸&柽-eonun</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://eonun.com/posts/a3b2c5a/" title="BIOS、UEFI、MBR、GPT都是啥呢">https://eonun.com/posts/a3b2c5a/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="followme"><p>欢迎关注我的其它发布渠道</p><div class="social-list"><div class="social-item"><a target="_blank" class="social-link" href="/atom.xml"><span class="icon"><i class="fa fa-rss"></i> </span><span class="label">RSS</span></a></div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/BIOS/" rel="tag"><i class="fa fa-tag"></i> BIOS</a> <a href="/tags/UEFI/" rel="tag"><i class="fa fa-tag"></i> UEFI</a> <a href="/tags/MBR/" rel="tag"><i class="fa fa-tag"></i> MBR</a> <a href="/tags/GPT/" rel="tag"><i class="fa fa-tag"></i> GPT</a></div><div class="post-nav"><div class="post-nav-item"><a href="/posts/e4b0c9cf/" rel="prev" title="ArchLinux安装后配置"><i class="fa fa-chevron-left"></i> ArchLinux安装后配置</a></div><div class="post-nav-item"><a href="/posts/331864ab/" rel="next" title="ArchLinux系安装VMware">ArchLinux系安装VMware <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><script>window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.</span> <span class="nav-text">启动模式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#BIOS"><span class="nav-number">1.1.</span> <span class="nav-text">BIOS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UEFI"><span class="nav-number">1.2.</span> <span class="nav-text">UEFI</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#EFI"><span class="nav-number">1.2.1.</span> <span class="nav-text">EFI</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UEFI-1"><span class="nav-number">1.2.2.</span> <span class="nav-text">UEFI</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UEFI%E5%92%8CBIOS%E6%AF%94%E8%BE%83%E3%80%82"><span class="nav-number">1.3.</span> <span class="nav-text">UEFI和BIOS比较。</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA"><span class="nav-number">2.</span> <span class="nav-text">磁盘分区</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#MBR-Master-Boot-Record-%E4%B8%BB%E5%BC%95%E5%AF%BC%E8%AE%B0%E5%BD%95"><span class="nav-number">2.1.</span> <span class="nav-text">MBR(Master Boot Record,主引导记录)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GPT-GUID-Partition-Table-%E5%85%A8%E5%B1%80%E5%94%AF%E4%B8%80%E6%A0%87%E8%AF%86%E5%88%86%E5%8C%BA%E8%A1%A8"><span class="nav-number">2.2.</span> <span class="nav-text">GPT(GUID Partition Table,全局唯一标识分区表)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%A0%E7%BB%9FMBR"><span class="nav-number">2.2.1.</span> <span class="nav-text">传统MBR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E5%8C%BA%E8%A1%A8%E5%A4%B4"><span class="nav-number">2.2.2.</span> <span class="nav-text">分区表头</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E5%8C%BA%E8%A1%A8%E9%A1%B9"><span class="nav-number">2.2.3.</span> <span class="nav-text">分区表项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%94%AF%E6%8C%81"><span class="nav-number">2.2.4.</span> <span class="nav-text">操作系统支持</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B"><span class="nav-number">3.</span> <span class="nav-text">计算机启动过程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#BIOS%E5%90%AF%E5%8A%A8%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%9A%84%E8%BF%87%E7%A8%8B"><span class="nav-number">3.1.</span> <span class="nav-text">BIOS启动计算机的过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UEFI%E5%90%AF%E5%8A%A8%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%9A%84%E8%BF%87%E7%A8%8B"><span class="nav-number">3.2.</span> <span class="nav-text">UEFI启动计算机的过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A6%82%E6%8B%AC%EF%BC%9A"><span class="nav-number">3.3.</span> <span class="nav-text">概括：</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%82%E8%80%83%EF%BC%8C%E6%89%A9%E5%B1%95"><span class="nav-number">4.</span> <span class="nav-text">参考，扩展</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="木He寸&柽-eonun" src="/images/me.png"><p class="site-author-name" itemprop="name">木He寸&柽-eonun</p><div class="site-description" itemprop="description">努力即为天意！</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">111</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">26</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">71</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/eonun" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;eonun" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:eonun47@gmail.com" title="E-Mail → mailto:eonun47@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a> </span><span class="links-of-author-item"><a href="https://weibo.com/eonun" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;eonun" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a> </span><span class="links-of-author-item"><a href="https://twitter.com/eonun" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;eonun" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a></span></div><div class="cc-license motion-element" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; 2019 – <span itemprop="copyrightYear">2021</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">木He寸&柽-eonun</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span>第&nbsp<span id="busuanzi_value_site_uv"></span>&nbsp位朋友</span> </span><span class="post-meta-divider">|</span> <span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span>经&nbsp<span id="busuanzi_value_site_pv"></span>&nbsp回眸与你相遇</span></span></div></div></footer></div><script src="/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script><script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script defer src="//cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/three.min.js"></script><script defer src="//cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/three-waves.min.js"></script><script src="/js/local-search.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,log:!1,model:{jsonPath:"/live2dw/assets/tororo.model.json"},display:{position:"right",width:300,height:600},mobile:{show:!0},react:{opacity:.9}})</script></body></html>